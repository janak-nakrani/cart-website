<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shoping Page</title>
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous"> -->
        <link rel="stylesheet" href="../cdn/bootstrap.css">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"
        integrity="sha384-fbbOQedDUMZZ5KreZpsbe1LCZPVmfTnH7ois6mU1QK+m14rQ1l2bGBq41eYeM/fS"
        crossorigin="anonymous"></script>
    <script src="JSMain.js"></script>
    <!-- <link rel="stylesheet" href="JSMain.css"> -->
    <!-- <script src="../../shittal/bootstrap.js"></script> -->

    <style>
        img{
    aspect-ratio: 3/4;
}
.button {
    --color: #a5ebe7;
    padding: 2px 12px;
    background-color: transparent;
    border-radius: .3em;
    position: relative;
    overflow: hidden;
    cursor: pointer;
    transition: .5s;
    font-weight: 400;
    font-size: 17px;
    border: 1px solid;
    font-family: inherit;
    color: var(--color);
    z-index: 1;
   }
   
   .button::before, .button::after {
    content: '';
    display: block;
    width: 50px;
    height: 50px;
    transform: translate(-50%, -50%);
    position: absolute;
    border-radius: 50%;
    z-index: -1;
    background-color: var(--color);
    transition: 1s ease;
   }
   
   .button::before {
    top: -1em;
    left: -1em;
   }
   
   .button::after {
    left: calc(100% + 1em);
    top: calc(100% + 1em);
   }
   
   .button:hover::before, .button:hover::after {
    height: 410px;
    width: 410px;
   }
   
   .button:hover {
    color: rgb(10, 25, 30);
   }
   
   .button:active {
    filter: brightness(.8);
   }
   
    </style>
</head>

<body onload="initialize()">
    <header class="bg-dark sticky-top d-flex text-center">
        <a class="text-decoration-none text-light p-3 me-auto">
            <h2> Shoping Page </h2>
        </a>
        <button type="button" class="my-auto me-5 btn btn-dark position-relative" data-bs-toggle="offcanvas"
            data-bs-target="#YourCart">
            <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="#fff" class="bi bi-cart-fill"
                viewBox="0 0 16 16">
                <path
                    d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
            </svg>
            <span class="position-absolute top-0 start-50 translate-middle badge rounded-circle bg-primary"
                id="num">0</span>
        </button>
    </header>
    <div class="offcanvas offcanvas-end" data-bs-backdrop="static" tabindex="-3" id="YourCart">
        <div class="offcanvas-header border-bottom bg-dark text-light">
            <h5 class="offcanvas-title">Shopping cart</h5>
            <button type="button" class="btn-close bg-secondary" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body position-relative">
            <div class="container" id="CartBody">
                <h2 class="display-1 fw-bold text-center">Oops your cart is Empty</h2>
            </div>
        </div>
        <div class="offcanvas-footer border-top d-flex p-3 bg-dark text-light text-center">
            <h6 class="me-auto" id="Qty">Quantity : 0 pcs</h6>
            <button class='button'>Place Order</button>
            <h6 class="ms-auto" id="total">Total : 0 Rs</h6>
        </div>
    </div>

    <div class="main bg-secondary bg-opacity-25">
        <div class="container py-3">
            <div class="row row-cols-md-5 row-cols-1 g-3" id="CardMain"></div>
        </div>
    </div>

    <footer class="text-center bg-dark p-2">
        <a href="" class="text-decoration-none text-light">
            <h3>Thanks for visiting</h3>
        </a>
    </footer>
</body>

<script>
    const shopping = [
            ["Pink tshirt", "images/Tshirt1.jpg", 600],
            ["White tshirt", "images/Tshirt2.jpg", 620],
            ["Yellow tshirt", "images/Tshirt3.jpg", 540],
            ["Black tshirt", "images/Tshirt4.webp", 870],
            ["BLue tshirt", "images/Tshirt5.jpg", 730],
            ["Orange tshirt", "images/Tshirt6.jpg", 580],
            ["Red tshirt", "images/Tshirt7.jpg", 760],
            ["Olive tshirt", "images/Tshirt8.jpg", 830],
            ["Grey tshirt", "images/Tshirt9.webp", 650],
            ["Peach tshirt", "images/Tshirt10.jpg", 900]
        ]

        body = "";
        for (let i = 0; i < shopping.length; i++) {
            body += `<div class="col p-2">
                <div class="card bg-dark text-light text-center">
                    <div class="card-header">${shopping[i][0]}</div>
                        <div class="text-center card-image card-image-hover-zoom"> 
                        <img class="img-thumbnail w-75" src="${shopping[i][1]}">
                        </div>
                    <div class="card-body">
                        <div class="card-title" id="amount">Price : ${shopping[i][2]}</div>
                        <button class="btn btn-primary p-2" onclick="addtoCart(${[i]})">add to cart</button>
                    </div>
                </div>
            </div>` ;
        }

        function initialize() {
            document.getElementById("CardMain").innerHTML = body;
        }

        const cart = [];

        function addtoCart(i) {

            let name = shopping[i][0];
            let images = shopping[i][1];
            let price = shopping[i][2];
            let Qtys = 1;
            let position = i;

            // var index = Data.map(function(e) { return e.name; }).indexOf('Nick');
            let keyofPosition = cart.map(function (e) { return e.position; }).indexOf(position);
            console.log(keyofPosition);

            if (keyofPosition != -1) {
                cart[keyofPosition]["price"] += shopping[i][2];
                cart[keyofPosition]["quantity"] += 1;
            } else {
                cartitem = { "name": name, "image": images, "price": price, "quantity": Qtys, "position": position };
                cart.push(cartitem);
            }

            // Or
            // if(keyofPosition == -1) {
            //     cartitem = { "name": name, "image": images, "price": price, "quantity": Qtys, "position": position };
            //     cart.push(cartitem);
            // } else {
            //     cart[keyofPosition]["price"] += shopping[i][2];
            //     cart[keyofPosition]["quantity"] += 1;
            // }

            //if(cart.length > 0) {
            // for (let j = 0; j < cart.length; j++) {
            //     //alert(cart[j]["index"]);
            //     if(cart[j]["index"] == index) {
            //         cart[j]["price"] += shopping[i][2];
            //         cart[j]["quantity"] += 1;
            //         break;
            //     } else {
            //         cartitem = { "name": name, "image": images, "price": price, "quantity": Qtys, "index": index };
            //         cart.push(cartitem);
            //         break;
            //     }
            //     console.log("++++++++++");
            // }
            //} else {
            // cartitem = { "name": name, "image": images, "price": price, "quantity": Qtys, "index": index };
            // cart.push(cartitem);
            //}
            console.log(cart);

            prepareacarthtml(cart);
        }


        function prepareacarthtml(cart) {
            let carthtml = "";
            let num = 0;
            let Total = 0;
            let nos = 0;
            for (let n in cart) {
                num += 1;
                Total += cart[n]["price"];
                nos += 1;
                carthtml +=
                    `<div class="card mb-3">
                <div class="row g-0">
                    <div class="col-4 text-center">
                        <img src="${cart[n]["image"]}" class="img-fluid rounded-start border-end" alt="...">
                    </div>
                    <div class="col-md-8">
                        <div class="card-body">
                            <button type="button" class="btn-close position-absolute top-0 end-0" onclick="removecartitem(${n})">
                            </button>
                            <p><strong>Item : </strong>${cart[n]["name"]}</p>
                            <p><strong>Price : </strong>${cart[n]["price"]} Rs</p>
                            <p><strong>Qty : </strong>${cart[n]["quantity"]} nos</p>
                        </div>
                    </div>
                </div>
            </div>`

            }
            document.getElementById("CartBody").innerHTML = carthtml;
            document.getElementById("num").innerHTML = num;
            document.getElementById("total").innerHTML = "Total : " + Total + " Rs";
            document.getElementById("Qty").innerHTML = "Total item : " + nos;
        }

        function removecartitem(key) {
            cart.splice(key, 1)
            prepareacarthtml(cart)
        }
</script>

</html>
